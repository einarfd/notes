{% extends "base.html" %}

{% block title %}{{ note.title }} - Notes{% endblock %}

{% block content %}
<div class="card">
    {% if editing %}
    {% if error %}
    <div class="error-message">{{ error }}</div>
    {% endif %}
    <form method="POST" action="/notes/{{ note.path }}">
        <div class="form-group">
            <label for="title">Title</label>
            <input type="text" id="title" name="title" value="{{ note.title }}" required>
        </div>
        <div class="form-group">
            <label for="tags">Tags (comma-separated)</label>
            <input type="text" id="tags" name="tags" value="{{ note.tags | join(', ') }}">
        </div>
        <div class="form-group">
            <label for="content">Content</label>
            <textarea id="content" name="content">{{ note.content }}</textarea>
        </div>
        <div class="actions">
            <button type="submit" class="btn">Save</button>
            <a href="/notes/{{ note.path }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
    {% else %}
    <h2>{{ note.title }}</h2>
    <div class="metadata">
        <strong>Path:</strong> {{ note.path }}<br>
        <strong>Created:</strong> {{ note.created_at }}<br>
        <strong>Updated:</strong> {{ note.updated_at }}
    </div>
    {% if note.tags %}
    <div style="margin-bottom: 15px;">
        {% for tag in note.tags %}
        <a href="/tags/{{ tag }}" class="tag">{{ tag }}</a>
        {% endfor %}
    </div>
    {% endif %}
    <div class="note-content">{{ note.content }}</div>
    <div class="actions">
        <a href="/notes/{{ note.path }}/edit" class="btn">Edit</a>
        <form method="POST" action="/notes/{{ note.path }}/delete" style="display:inline;"
              onsubmit="return confirm('Are you sure you want to delete this note?');">
            <button type="submit" class="btn btn-danger">Delete</button>
        </form>
    </div>
    {% endif %}
</div>
{% endblock %}
